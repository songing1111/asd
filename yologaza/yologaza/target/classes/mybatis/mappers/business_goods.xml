<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.business.goods">
<!-- 리절트 맵 정의 -->	
	<resultMap id="goodsResult" type="goodsVO">
		<result property="goods_id" column="goods_id" />
		<result property="goods_type" column="goods_type" />
		<result property="goods_email1" column="goods_email1" />
		<result property="goods_email2" column="goods_email2" />
		<result property="goods_hp" column="goods_hp" />		
		<result property="goods_tel1" column="goods_tel1" />
		<result property="goods_tel2" column="goods_tel2" />
		<result property="goods_tel3" column="goods_tel3" />
		<result property="account_bank" column="account_bank" />
		<result property="account_name" column="account_name" />
		<result property="account" column="account" />		
		<result property="goods_homePage" column="goods_homePage" />
		<result property="goods_name" column="goods_name" />
		<result property="goods_address" column="goods_address" />		
		<result property="goods_description" column="goods_description" />
		<result property="goods_room_price1" column="goods_room_price1" />
		<result property="goods_room_price2" column="goods_room_price2" />
		<result property="goods_baseImpormation" column="goods_baseImpormation" />
		<result property="goods_chargeImpormation" column="goods_chargeImpormation" />
		<result property="goods_checkIn" column="goods_checkIn" />
		<result property="goods_checkOut" column="goods_checkOut" />
		<result property="goods_motel_endtime" column="goods_motel_endtime" />
		<result property="goods_motel_usetime" column="goods_motel_usetime" />
		<result property="goods_price1" column="goods_price1" />
		<result property="goods_price2" column="goods_price2" />
		<result property="goods_acess" column="goods_acess" />

		<result property="goods_room" column="goods_room" />
		<result property="goods_room_num" column="goods_room_num" />
		<result property="goods_uroom_detail" column="goods_uroom_detail" />
		<result property="goods_room_name" column="goods_room_name" />
		<result property="goods_room_type" column="goods_room_type" />
		<result property="goods_capacity" column="goods_capacity" />
		<result property="goods_introduce" column="goods_introduce" />
		
	</resultMap>

	<resultMap id="imageResult" type="ImageFileVO">
		<result property="goods_uimg" column="goods_uimg" />
	   <result property="goods_id" column="goods_id" />
	   <result property="fileName" column="fileName" />
	   <result property="image_id" column="image_id" />
	   <result property="fileType" column="fileType" />
	   <result property="reg_id" column="reg_id" />
	</resultMap>
	
	<select id="selectNewGoodsList" resultMap="goodsResult"   parameterType="java.util.Map"  >
	    <![CDATA[
			select * from (
						   select @ROWNUM:=@ROWNUM+1 as recNum,
						   		  goods_id,
						          goods_name,
						          goods_address,
						          goods_checkIn,
			                      goods_checkIn,
						          date_format(goods_creDate,'%Y-%m-%d') as goods_creDate
						       from (
						             select  goods_id,
											 goods_name,
											 goods_address,
											 goods_checkIn,
											 goods_checkOut,
			                                 goods_creDate
						              from goods
						              where date_format(goods_creDate,'%Y-%m-%d') between #{beginDate} and #{endDate}
						              order by goods_creDate desc
								    ) s
							) t	
			
						where				
						recNum between (#{section}-1)*100+ (#{pageNum}-1)*10+1 and (#{section}-1)*100+(#{pageNum})*10	        
    	]]>
	</select>
	
	<insert id="insertNewGoods" parameterType="java.util.Map"   >
		<selectKey resultType="String" keyProperty="goods_id" order="BEFORE">
	    	<!-- select seq_goods_id.nextval from dual -->
	    	select nextval('SEQ_GOODS_ID') from dual
	    </selectKey>
	    
	    <![CDATA[
		   insert into goods(
						                goods_id, 
						                goods_type,
					                    goods_email1,
					                    goods_email2,
					                    goods_hp,
										goods_tel1,
										goods_tel2,
										goods_tel3,
										account_bank,
										account_name,
										account,
										goods_homePage,
										goods_name,
										goods_address,
										goods_description,
										goods_baseImpormation,
										goods_chargeImpormation,
										goods_checkIn,
										goods_checkOut,
										goods_motel_endtime,
										goods_motel_usetime,
										goods_price1,
										goods_price2)
										
					  			values(
					  			      #{goods_id},
					  			      #{goods_type},
					  			      #{goods_email1},
					  			      #{goods_email2},
					  			     
					  			      #{goods_hp },
					  			      #{goods_tel1},
					  			      #{goods_tel2},
					  			      #{goods_tel3},
					  			      #{account_bank},
					  			      
					  			      #{account_name},
					  			      #{account },
					  			      #{goods_name },
					  			      #{goods_address },
					  			      #{goods_description },
					  			      #{goods_baseImpormation},
											
									  #{goods_chargeImpormation},
					  			      #{goods_checkIn },
					  			      #{goods_checkOut },	
					  			      #{goods_motel_endtime},
					  			      #{goods_motel_usetime},
					  			      #{goods_price1 },
					  			      #{goods_price2 }
					 			 )
		]]>
	</insert>
	
	<insert id="insertGoodsImageFile" parameterType="imageFileVO"   >
		<selectKey resultType="int" keyProperty="goods_uimg" order="BEFORE">
	    	select nextval('SEQ_IMAGE_ID') from dual
	    </selectKey>
	    <![CDATA[
		   insert into goods_img (goods_uimg,
                                 goods_id,
								 reg_id,
								 fileName,
								 fileType
								 )
   						values(#{goods_uimg},
   					 			 #{goods_id},
   								 #{reg_id},
   								 #{fileName},
   								 #{fileType}
   								  )
		]]>
	</insert> 
	
</mapper>